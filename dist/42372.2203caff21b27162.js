"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[42372],{42372:(R,u,o)=>{o.r(u),o.d(u,{BuyModule:()=>T});var e=o(81180),m=o(40031),h=o(91860),y=o(12236),l=o(47530),v=o(41840),r=o(44328),c=o(15047),a=o(99468),P=o(70183);const g=[{path:"",component:(()=>{var s;class n extends v.c{constructor(t,i,p,B,f,S){super(t),(0,e.Z)(this,"_activatedRoute",void 0),(0,e.Z)(this,"_router",void 0),(0,e.Z)(this,"_paymnetHelperService",void 0),(0,e.Z)(this,"_paymentAppService",void 0),(0,e.Z)(this,"_tenantRegistrationService",void 0),(0,e.Z)(this,"editionPaymentType",void 0),(0,e.Z)(this,"edition",new r._6E),(0,e.Z)(this,"tenantId",abp.session.tenantId),(0,e.Z)(this,"paymentPeriodType",r.dw4),(0,e.Z)(this,"selectedPaymentPeriodType",void 0),(0,e.Z)(this,"subscriptionPaymentGateway",r.UWJ),(0,e.Z)(this,"paymentGateways",void 0),(0,e.Z)(this,"supportsRecurringPayments",!1),(0,e.Z)(this,"recurringPaymentEnabled",!1),(0,e.Z)(this,"editionId",0),this._activatedRoute=i,this._router=p,this._paymnetHelperService=B,this._paymentAppService=f,this._tenantRegistrationService=S}ngOnInit(){let t=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(t),this.editionPaymentType=this._activatedRoute.snapshot.queryParams.editionPaymentType,this.editionId=this._activatedRoute.snapshot.queryParams.editionId,this._tenantRegistrationService.getEdition(this.editionId).subscribe(i=>{this.edition=i,this.selectedPaymentPeriodType=this._paymnetHelperService.getInitialSelectedPaymentPeriodType(this.edition)}),this._paymentAppService.getActiveGateways(void 0).subscribe(i=>{this.paymentGateways=i,this.supportsRecurringPayments=i.some(p=>p.supportsRecurringPayments)}),this.checkout(r.UWJ.Stripe)}checkout(t){let i={};i.editionId=this.editionId,i.editionPaymentType=this.editionPaymentType,i.paymentPeriodType=r.dw4.Monthly,i.recurringPaymentEnabled=this.recurringPaymentEnabled,i.subscriptionPaymentGatewayType=t,i.successUrl=c.g.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymnetHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",i.errorUrl=c.g.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(i).subscribe(p=>{this._router.navigate(["account/"+this.getPaymentGatewayType(t).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:p,redirectUrl:"account/register-tenant-result"}})})}getPaymentGatewayType(t){return this._paymnetHelperService.getPaymentGatewayType(t)}onPaymentPeriodChangeChange(t){this.selectedPaymentPeriodType=t}}return s=n,(0,e.Z)(n,"\u0275fac",function(t){return new(t||s)(a.Y36(a.zs3),a.Y36(y.gz),a.Y36(y.F0),a.Y36(P.T),a.Y36(r.KC),a.Y36(r.Zr1))}),(0,e.Z)(n,"\u0275cmp",a.Xpm({type:s,selectors:[["ng-component"]],features:[a.qOj],decls:1,vars:1,consts:[[1,"login-form"]],template:function(t,i){1&t&&a._UZ(0,"div",0),2&t&&a.Q6J("@routerTransition",void 0)},encapsulation:2,data:{animation:[(0,l.RP)()]}})),n})(),pathMatch:"full"}];let Z=(()=>{var s;class n{}return s=n,(0,e.Z)(n,"\u0275fac",function(t){return new(t||s)}),(0,e.Z)(n,"\u0275mod",a.oAB({type:s})),(0,e.Z)(n,"\u0275inj",a.cJS({imports:[y.Bz.forChild(g),y.Bz]})),n})(),T=(()=>{var s;class n{}return s=n,(0,e.Z)(n,"\u0275fac",function(t){return new(t||s)}),(0,e.Z)(n,"\u0275mod",a.oAB({type:s})),(0,e.Z)(n,"\u0275inj",a.cJS({imports:[m.o,h.y,Z]})),n})()}}]);