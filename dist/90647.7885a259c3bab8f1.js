"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[90647],{90647:(j,u,s)=>{s.r(u),s.d(u,{PaypalPurchaseModule:()=>x});var a=s(81180),m=s(40031),p=s(12236),y=s(41840),P=s(49291),v=s(47530),g=s(62660),d=s(44328),e=s(99468),f=s(97708),c=s(96814),Z=s(94901),b=s(3291);function I(i,n){if(1&i&&(e.TgZ(0,"div",13)(1,"span",14),e._UZ(2,"i",15),e.qZA(),e.TgZ(3,"div",16)(4,"h4",17),e._uU(5),e.qZA(),e.TgZ(6,"span")(7,"p")(8,"span"),e._uU(9),e.TgZ(10,"strong"),e._uU(11),e.qZA()(),e._UZ(12,"br"),e.TgZ(13,"span"),e._uU(14),e.TgZ(15,"strong"),e._uU(16),e.qZA()()()()()()),2&i){const r=e.oxw();e.xp6(5),e.hij(" ",r.l("DemoPayPalAccount"),""),e.xp6(4),e.hij("",r.l("UserName"),": "),e.xp6(2),e.Oqu(r.config.demoUsername),e.xp6(3),e.hij("",r.l("Password"),": "),e.xp6(2),e.Oqu(r.config.demoPassword)}}function U(i,n){if(1&i&&e._UZ(0,"div",18),2&i){const r=e.oxw();e.Q6J("busyIf",r.paypalIsLoading)}}const A=[{path:"",component:(()=>{var i;class n extends y.c{constructor(t,o,l,h,R,S){super(t),(0,a.Z)(this,"_activatedRoute",void 0),(0,a.Z)(this,"_payPalPaymentAppService",void 0),(0,a.Z)(this,"_paymentAppService",void 0),(0,a.Z)(this,"_router",void 0),(0,a.Z)(this,"_tenantRegistrationHelper",void 0),(0,a.Z)(this,"editionPaymentType",void 0),(0,a.Z)(this,"config",void 0),(0,a.Z)(this,"paypalIsLoading",!0),(0,a.Z)(this,"subscriptionPaymentGateway",d.UWJ),(0,a.Z)(this,"totalAmount",0),(0,a.Z)(this,"description",""),(0,a.Z)(this,"paymentId",void 0),(0,a.Z)(this,"redirectUrl",void 0),(0,a.Z)(this,"successCallbackUrl",void 0),(0,a.Z)(this,"errorCallbackUrl",void 0),this._activatedRoute=o,this._payPalPaymentAppService=l,this._paymentAppService=h,this._router=R,this._tenantRegistrationHelper=S}ngOnInit(){this.setTenantIdCookieIfNeeded(),this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,this.redirectUrl=this._activatedRoute.snapshot.queryParams.redirectUrl,this._payPalPaymentAppService.getConfiguration().subscribe(t=>{this.config=t;let o=this.GetDisabledFundingsQueryString(t);(new P.$).load("https://www.paypal.com/sdk/js?client-id="+t.clientId+"&currency="+this.appSession.application.currency+o).then(()=>{this._paymentAppService.getPayment(this.paymentId).subscribe(l=>{this.description=l.description,this.totalAmount=l.amount,this.successCallbackUrl=l.successUrl,this.errorCallbackUrl=l.errorUrl,this.subscriptionPaymentGateway=l.gateway,this.paypalIsLoading=!1,this.preparePaypalButton()})})})}preparePaypalButton(){const t=this;window.paypal.Buttons({createOrder:function(o,l){return l.order.create({purchase_units:[{amount:{value:t.totalAmount,currency_code:t.appSession.application.currency}}]})},onApprove:function(o,l){t._payPalPaymentAppService.confirmPayment(t.paymentId,o.orderID).subscribe(()=>{g.I.ajax("post",t.successCallbackUrl+(t.successCallbackUrl.includes("?")?"&":"?")+"paymentId="+t.paymentId,null,null,h=>{t._tenantRegistrationHelper.registrationResult&&(t._tenantRegistrationHelper.registrationResult.isActive=!0),t._router.navigate([t.redirectUrl])})})}}).render("#paypal-button")}GetDisabledFundingsQueryString(t){return!t.disabledFundings||t.disabledFundings.length<=0?"":"&disable-funding="+t.disabledFundings.join()}setTenantIdCookieIfNeeded(){if(!this._activatedRoute.snapshot.queryParams.tenantId)return;let t=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(t)}}return i=n,(0,a.Z)(n,"\u0275fac",function(t){return new(t||i)(e.Y36(e.zs3),e.Y36(p.gz),e.Y36(d.ou5),e.Y36(d.KC),e.Y36(p.F0),e.Y36(f.K))}),(0,a.Z)(n,"\u0275cmp",e.Xpm({type:i,selectors:[["paypal-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[e.qOj],decls:23,vars:14,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header","align-items-center"],[1,"fw-bolder","text-dark","fs-h4","fs-h1-lg"],[1,"card-body"],[1,"mb-5","row"],[1,"col-sm-4"],[1,"col-sm-8","text-end"],[1,"fw-bold"],["id","totalPrice",1,"fw-bold"],["class","alert bg-light-primary d-flex align-items-center p-5 mb-10",4,"ngIf"],["id","paypal-button"],[3,"busyIf",4,"ngIf"],[1,"alert","bg-light-primary","d-flex","align-items-center","p-5","mb-10"],[1,"svg-icon","svg-icon-2hx","svg-icon-primary","me-4"],[1,"fas","fa-info-circle","fs-1"],[1,"d-flex","flex-column"],[1,"mb-1","text-primary"],[3,"busyIf"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e._uU(4),e.ALo(5,"localize"),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9),e.qZA(),e.TgZ(10,"div",7)(11,"p",8),e._uU(12),e.qZA()()(),e.TgZ(13,"div",5)(14,"label",6),e._uU(15),e.qZA(),e.TgZ(16,"div",7)(17,"p",9),e._uU(18),e.ALo(19,"number"),e.qZA()()(),e.YNc(20,I,17,5,"div",10),e._UZ(21,"div",11),e.YNc(22,U,1,1,"div",12),e.qZA()()()),2&t&&(e.Q6J("@routerTransition",void 0),e.xp6(4),e.hij(" ",e.lcZ(5,9,"TenantSignUp")," "),e.xp6(5),e.Oqu(o.l("Item")),e.xp6(3),e.hij(" ",o.description," "),e.xp6(3),e.Oqu(o.l("Price")),e.xp6(3),e.AsE(" ",o.appSession.application.currencySign,"",e.xi3(19,11,o.totalAmount,"1.2-2")," "),e.xp6(2),e.Q6J("ngIf",o.config&&o.config.demoUsername&&o.config.demoPassword),e.xp6(2),e.Q6J("ngIf",o.paypalIsLoading))},dependencies:[c.O5,Z.U,c.JJ,b.F],encapsulation:2,data:{animation:[(0,v.RP)()]}})),n})(),pathMatch:"full"}];let T=(()=>{var i;class n{}return i=n,(0,a.Z)(n,"\u0275fac",function(t){return new(t||i)}),(0,a.Z)(n,"\u0275mod",e.oAB({type:i})),(0,a.Z)(n,"\u0275inj",e.cJS({imports:[p.Bz.forChild(A),p.Bz]})),n})();var C=s(91860);let x=(()=>{var i;class n{}return i=n,(0,a.Z)(n,"\u0275fac",function(t){return new(t||i)}),(0,a.Z)(n,"\u0275mod",e.oAB({type:i})),(0,a.Z)(n,"\u0275inj",e.cJS({imports:[m.o,C.y,T]})),n})()}}]);