"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[44478],{44478:(re,m,s)=>{s.r(m),s.d(m,{RolesModule:()=>se});var r=s(81180),u=s(12236),b=s(47530),g=s(41840),c=s(44328),T=s(66232),f=s(64716),e=s(99468),_=s(96814),p=s(73552),v=s(76388),x=s(94901),R=s(56916),C=s(85219),M=s(59170),A=s(68989),d=s(56223),Z=s(14647),O=s(45513),E=s(42152),N=s(24142),w=s(99824),h=s(3291);const H=["createOrEditModal"],L=["permissionTree"];function z(o,l){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o){const i=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"EditRole"),": ",i.role.displayName,"")}}function J(o,l){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CreateNewRole")))}function S(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("ngSubmit",function(){e.CHM(i);const t=e.oxw();return e.KtG(t.save())}),e.TgZ(2,"div",7)(3,"h4",8),e.YNc(4,z,3,4,"span",9),e.YNc(5,J,3,3,"span",9),e.qZA(),e.TgZ(6,"button",10),e.NdJ("click",function(){e.CHM(i);const t=e.oxw();return e.KtG(t.close())}),e.qZA()(),e.TgZ(7,"div",11)(8,"tabset",12)(9,"tab",13),e.ALo(10,"localize"),e.TgZ(11,"div",14)(12,"label",15),e._uU(13),e.ALo(14,"localize"),e.qZA(),e.TgZ(15,"input",16,17),e.NdJ("ngModelChange",function(t){e.CHM(i);const a=e.oxw();return e.KtG(a.role.displayName=t)}),e.qZA(),e._UZ(17,"validation-messages",18),e.qZA(),e.TgZ(18,"label",19)(19,"input",20),e.NdJ("ngModelChange",function(t){e.CHM(i);const a=e.oxw();return e.KtG(a.role.isDefault=t)}),e.qZA(),e.TgZ(20,"span",21),e._uU(21),e.ALo(22,"localize"),e.TgZ(23,"small",22),e._uU(24),e.ALo(25,"localize"),e.qZA()()()(),e.TgZ(26,"tab",13),e.ALo(27,"localize"),e._UZ(28,"permission-tree",null,23),e.qZA()(),e.TgZ(30,"div",24)(31,"em"),e._uU(32),e.ALo(33,"localize"),e.qZA()()(),e.TgZ(34,"div",25)(35,"button",26),e.NdJ("click",function(){e.CHM(i);const t=e.oxw();return e.KtG(t.close())}),e._uU(36),e.ALo(37,"localize"),e.qZA(),e.TgZ(38,"button",27),e._UZ(39,"i",28),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"localize"),e.qZA()()()()}if(2&o){const i=e.MAs(1),n=e.MAs(16),t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.role.id),e.xp6(1),e.Q6J("ngIf",!t.role.id),e.xp6(1),e.Q6J("disabled",t.saving),e.uIk("aria-label",t.l("Close")),e.xp6(3),e.s9C("heading",e.lcZ(10,19,"RoleName")),e.xp6(4),e.hij("",e.lcZ(14,21,"RoleName")," *"),e.xp6(2),e.Q6J("ngModel",t.role.displayName),e.xp6(2),e.Q6J("formCtrl",n),e.xp6(2),e.Q6J("ngModel",t.role.isDefault),e.xp6(2),e.hij(" ",e.lcZ(22,23,"Default")," "),e.xp6(3),e.Oqu(e.lcZ(25,25,"DefaultRole_Description")),e.xp6(2),e.s9C("heading",e.lcZ(27,27,"Permissions")),e.xp6(6),e.Oqu(e.lcZ(33,29,"Note_RefreshPageForPermissionChanges")),e.xp6(3),e.Q6J("disabled",t.saving),e.xp6(1),e.hij(" ",e.lcZ(37,31,"Cancel")," "),e.xp6(2),e.Q6J("disabled",!i.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),e.xp6(3),e.Oqu(e.lcZ(42,33,"Save"))}}const F=function(o){return{backdrop:"static",keyboard:o}};let U=(()=>{var o;class l extends g.c{constructor(n,t){super(n),(0,r.Z)(this,"_roleService",void 0),(0,r.Z)(this,"modal",void 0),(0,r.Z)(this,"permissionTree",void 0),(0,r.Z)(this,"modalSave",new e.vpe),(0,r.Z)(this,"active",!1),(0,r.Z)(this,"saving",!1),(0,r.Z)(this,"role",new c.f78),this._roleService=t}show(n){const t=this;t.active=!0,t._roleService.getRoleForEdit(n).subscribe(a=>{t.role=a.role,this.permissionTree.editData=a,t.modal.show()})}onShown(){document.getElementById("RoleDisplayName").focus()}save(){const t=new c.H$n;t.role=this.role,t.grantedPermissionNames=this.permissionTree.getGrantedPermissionNames(),this.saving=!0,this._roleService.createOrUpdateRole(t).pipe((0,f.x)(()=>this.saving=!1)).subscribe(()=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.modalSave.emit(null)})}close(){this.active=!1,this.modal.hide()}}return o=l,(0,r.Z)(l,"\u0275fac",function(n){return new(n||o)(e.Y36(e.zs3),e.Y36(c.AR1))}),(0,r.Z)(l,"\u0275cmp",e.Xpm({type:o,selectors:[["createOrEditRoleModal"]],viewQuery:function(n,t){if(1&n&&(e.Gf(H,7),e.Gf(L,5)),2&n){let a;e.iGM(a=e.CRH())&&(t.modal=a.first),e.iGM(a=e.CRH())&&(t.permissionTree=a.first)}},outputs:{modalSave:"modalSave"},features:[e.qOj],decls:5,vars:4,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","createOrEditModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["createOrEditModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["novalidate","","autocomplete","new-password",3,"ngSubmit",4,"ngIf"],["novalidate","","autocomplete","new-password",3,"ngSubmit"],["roleForm","ngForm"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"tab-container","tabbable-line"],[1,"p-5",3,"heading"],[1,"mb-5"],[1,"form-label"],["id","RoleDisplayName","type","text","name","DisplayName","required","","maxlength","64",1,"form-control",3,"ngModel","ngModelChange"],["roleNameInput","ngModel"],[3,"formCtrl"],[1,"form-check","form-check-custom","form-check-solid","py-1"],["id","EditRole_IsDefault","type","checkbox","name","IsDefault",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"form-text","text-muted"],["permissionTree",""],[1,"alert","alert-warning",2,"margin-top","30px"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-save"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return t.onShown()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,S,43,35,"form",4),e.qZA()()()),2&n&&(e.Q6J("config",e.VKq(2,F,!t.saving)),e.xp6(4),e.Q6J("ngIf",t.active))},dependencies:[_.O5,d._Y,d.Fj,d.Wl,d.JJ,d.JL,d.Q7,d.nD,d.On,d.F,Z.wW,Z.AH,O.L,E.s,N.Z,w.I,h.F],encapsulation:2})),l})();var I=s(88922),P=s(83410),Q=s(98155);const D=["createOrEditRoleModal"],G=["entityTypeHistoryModal"],j=["dataTable"],q=["permissionFilterTreeModal"];function Y(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(i);const t=e.oxw();return e.KtG(t.createRole())}),e._UZ(1,"i",30),e.TgZ(2,"span",17),e._uU(3),e.ALo(4,"localize"),e.qZA()()}2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"CreateNewRole")," "))}const y=function(){return["Pages.Administration.Roles.Edit","Pages.Administration.Roles.Delete"]};function B(o,l){1&o&&(e.TgZ(0,"tr")(1,"th",31),e.ALo(2,"permissionAny"),e._uU(3),e.ALo(4,"localize"),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.ALo(7,"localize"),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.ALo(10,"localize"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("hidden",!e.lcZ(2,4,e.DdM(12,y))),e.xp6(2),e.hij(" ",e.lcZ(4,6,"Actions")," "),e.xp6(3),e.Oqu(e.lcZ(7,8,"RoleName")),e.xp6(3),e.Oqu(e.lcZ(10,10,"CreationTime")))}function k(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"li",43)(1,"a",44),e.NdJ("click",function(){e.CHM(i);const t=e.oxw(2).$implicit;e.oxw();const a=e.MAs(33);return e.KtG(a.show(t.id))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Edit")," "))}function K(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"li",43)(1,"a",44),e.NdJ("click",function(){e.CHM(i);const t=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.deleteRole(t))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Delete")," "))}function $(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"li",43)(1,"a",44),e.NdJ("click",function(){e.CHM(i);const t=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.showHistory(t))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"History")," "))}function W(o,l){if(1&o&&(e.TgZ(0,"ul",41),e.YNc(1,k,4,3,"li",42),e.ALo(2,"permission"),e.YNc(3,K,4,3,"li",42),e.ALo(4,"permission"),e.YNc(5,$,4,3,"li",42),e.qZA()),2&o){const i=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,"Pages.Administration.Roles.Edit")),e.xp6(2),e.Q6J("ngIf",!i.isStatic&&e.lcZ(4,5,"Pages.Administration.Roles.Delete")),e.xp6(2),e.Q6J("ngIf",n.entityHistoryEnabled)}}function X(o,l){1&o&&(e.TgZ(0,"span",45),e.ALo(1,"localize"),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&o&&(e.s9C("title",e.lcZ(1,2,"StaticRole_Tooltip")),e.xp6(2),e.hij(" ",e.lcZ(3,4,"Static")," "))}function V(o,l){1&o&&(e.TgZ(0,"span",46),e.ALo(1,"localize"),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&o&&(e.s9C("title",e.lcZ(1,2,"DefaultRole_Description")),e.xp6(2),e.hij(" ",e.lcZ(3,4,"Default")," "))}function ee(o,l){if(1&o&&(e.TgZ(0,"tr")(1,"td",32),e.ALo(2,"permissionAny"),e.TgZ(3,"div",33)(4,"button",34),e._UZ(5,"i",35)(6,"span",36),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.YNc(9,W,6,7,"ul",37),e.qZA()(),e.TgZ(10,"td")(11,"span",38),e._uU(12),e.ALo(13,"localize"),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.YNc(16,X,4,6,"span",39),e.YNc(17,V,4,6,"span",40),e.qZA()(),e.TgZ(18,"td")(19,"span",38),e._uU(20),e.ALo(21,"localize"),e.qZA(),e._uU(22),e.ALo(23,"luxonFormat"),e.qZA()()),2&o){const i=l.$implicit,n=e.oxw();e.xp6(1),e.Q6J("hidden",!(e.lcZ(2,8,e.DdM(19,y))||n.entityHistoryEnabled)),e.xp6(6),e.hij(" ",e.lcZ(8,10,"Actions")," "),e.xp6(5),e.Oqu(e.lcZ(13,12,"RoleName")),e.xp6(3),e.hij(" ",i.displayName," "),e.xp6(1),e.Q6J("ngIf",i.isStatic),e.xp6(1),e.Q6J("ngIf",i.isDefault),e.xp6(3),e.Oqu(e.lcZ(21,14,"CreationTime")),e.xp6(2),e.hij(" ",e.xi3(23,16,i.creationTime,"F")," ")}}function te(o,l){1&o&&(e.TgZ(0,"div",47),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const oe=function(){return{"min-width":"50rem"}},ne=[{path:"",component:(()=>{var o;class l extends g.c{constructor(n,t){super(n),(0,r.Z)(this,"_roleService",void 0),(0,r.Z)(this,"createOrEditRoleModal",void 0),(0,r.Z)(this,"entityTypeHistoryModal",void 0),(0,r.Z)(this,"dataTable",void 0),(0,r.Z)(this,"permissionFilterTreeModal",void 0),(0,r.Z)(this,"_entityTypeFullName","TR.CompanyQuote.Authorization.Roles.Role"),(0,r.Z)(this,"entityHistoryEnabled",!1),this._roleService=t}ngOnInit(){this.setIsEntityHistoryEnabled()}getRoles(){this.primengTableHelper.showLoadingIndicator();let n=this.permissionFilterTreeModal.getSelectedPermissions();this._roleService.getRoles(new c.mik({permissions:n})).pipe((0,f.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(t=>{this.primengTableHelper.records=t.items,this.primengTableHelper.totalRecordsCount=t.items.length,this.primengTableHelper.hideLoadingIndicator()})}createRole(){this.createOrEditRoleModal.show()}showHistory(n){this.entityTypeHistoryModal.show({entityId:n.id.toString(),entityTypeFullName:this._entityTypeFullName,entityTypeDescription:n.displayName})}deleteRole(n){this.message.confirm(this.l("RoleDeleteWarningMessage",n.displayName),this.l("AreYouSure"),a=>{a&&this._roleService.deleteRole(n.id).subscribe(()=>{this.getRoles(),abp.notify.success(this.l("SuccessfullyDeleted"))})})}setIsEntityHistoryEnabled(){let n=abp.custom;this.entityHistoryEnabled=n.EntityHistory&&n.EntityHistory.isEnabled&&1===(0,T.Z)(n.EntityHistory.enabledEntities,t=>t===this._entityTypeFullName).length}}return o=l,(0,r.Z)(l,"\u0275fac",function(n){return new(n||o)(e.Y36(e.zs3),e.Y36(c.AR1))}),(0,r.Z)(l,"\u0275cmp",e.Xpm({type:o,selectors:[["ng-component"]],viewQuery:function(n,t){if(1&n&&(e.Gf(D,7),e.Gf(G,7),e.Gf(j,7),e.Gf(q,7)),2&n){let a;e.iGM(a=e.CRH())&&(t.createOrEditRoleModal=a.first),e.iGM(a=e.CRH())&&(t.entityTypeHistoryModal=a.first),e.iGM(a=e.CRH())&&(t.dataTable=a.first),e.iGM(a=e.CRH())&&(t.permissionFilterTreeModal=a.first)}},features:[e.qOj],decls:36,vars:23,consts:[[1,"roles-container","container"],[1,"c-route-page-container"],[1,"p-28"],[3,"title","description"],["role","actions"],["class","btn btn-primary float-end",3,"click",4,"ngIf"],[1,"card","card-custom"],[1,"card-body"],[1,"form"],[1,"row"],[1,"col-6"],[1,"mb-5"],[3,"onModalclose"],["permissionFilterTreeModal",""],[1,"col-6","text-end"],["name","RefreshButton",1,"btn","btn-primary","float-end",3,"click"],[1,"la","la-refresh","btn-md-icon"],[1,"d-none","d-md-inline-block"],[1,"row","align-items-center"],[1,"primeng-datatable-container",3,"busyIf"],[3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"ui-table-footer"],[3,"modalSave"],["createOrEditRoleModal",""],["entityTypeHistoryModal",""],[1,"btn","btn-primary","float-end",3,"click"],[1,"fa","fa-plus","btn-md-icon"],[2,"width","130px",3,"hidden"],[3,"hidden"],["dropdown","","placement","bottom left","container","body",1,"btn-group"],["id","dropdownButton","type","button","dropdownToggle","","aria-controls","dropdownMenu",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog"],[1,"caret"],["id","dropdownMenu","class","dropdown-menu","role","menu","aria-labelledby","dropdownButton",4,"dropdownMenu"],[1,"p-column-title"],["class","badge badge-primary m-1","data-toggle","tooltip","data-placement","top",3,"title",4,"ngIf"],["class","badge badge-dark m-1","data-toggle","tooltip","data-placement","top",3,"title",4,"ngIf"],["id","dropdownMenu","role","menu","aria-labelledby","dropdownButton",1,"dropdown-menu"],["role","menuitem",4,"ngIf"],["role","menuitem"],["href","javascript:;",1,"dropdown-item",3,"click"],["data-toggle","tooltip","data-placement","top",1,"badge","badge-primary","m-1",3,"title"],["data-toggle","tooltip","data-placement","top",1,"badge","badge-dark","m-1",3,"title"],[1,"primeng-no-data"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"sub-header",3),e.ALo(4,"localize"),e.ALo(5,"localize"),e.TgZ(6,"div",4),e.YNc(7,Y,5,3,"button",5),e.ALo(8,"permission"),e.qZA()()()(),e.TgZ(9,"div")(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11)(16,"permission-tree-modal",12,13),e.NdJ("onModalclose",function(){return t.getRoles()}),e.qZA()()(),e.TgZ(18,"div",14)(19,"button",15),e.NdJ("click",function(){return t.getRoles()}),e._UZ(20,"i",16),e.TgZ(21,"span",17),e._uU(22),e.ALo(23,"localize"),e.qZA()()()()(),e.TgZ(24,"div",18)(25,"div",19)(26,"p-table",20,21),e.NdJ("onLazyLoad",function(){return t.getRoles()}),e.YNc(28,B,11,13,"ng-template",22),e.YNc(29,ee,24,20,"ng-template",23),e.qZA(),e.YNc(30,te,3,3,"div",24),e._UZ(31,"div",25),e.qZA()()()()(),e.TgZ(32,"createOrEditRoleModal",26,27),e.NdJ("modalSave",function(){return t.getRoles()}),e.qZA(),e._UZ(34,"entityTypeHistoryModal",null,28),e.qZA()),2&n&&(e.Q6J("@routerTransition",void 0),e.xp6(3),e.Q6J("title",e.lcZ(4,14,"Roles"))("description",e.lcZ(5,16,"RolesHeaderInfo")),e.xp6(4),e.Q6J("ngIf",e.lcZ(8,18,"Pages.Administration.Roles.Create")),e.xp6(2),e.Tol(t.containerClass),e.xp6(13),e.hij(" ",e.lcZ(23,20,"Refresh")," "),e.xp6(3),e.Q6J("busyIf",t.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",t.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",t.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(22,oe)),e.xp6(4),e.Q6J("ngIf",0==t.primengTableHelper.totalRecordsCount))},dependencies:[_.O5,p.Hz,p.Mq,p.TO,v.A,x.U,R.iA,C.jx,M.Z,A.$,U,I.n,h.F,P.a,Q.G],styles:[".toolbar[_ngcontent-%COMP%]{height:55px;display:flex;align-items:center;border-top:1px solid #EFF2F5;background:#ffffff;box-shadow:0 10px 30px #523f690d;left:265px;transition:left .3s ease;padding:0 30px}.roles-container[_ngcontent-%COMP%]{background-color:#f5f8ff}.roles-container[_ngcontent-%COMP%]   .c-route-page-container[_ngcontent-%COMP%]{font-family:Roboto,sans-serif}.roles-container[_ngcontent-%COMP%]   .c-route-page-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:1.14rem}.p-28[_ngcontent-%COMP%]{padding-top:28px;padding-bottom:28px}.search[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:50%;padding-bottom:0!important;margin-bottom:0!important}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex-shrink:0;border-radius:12px;background:var(--Primary-Base-White, #FFF);box-shadow:0 25.787px 53.723px 4.298px #5a52800d}.text-header[_ngcontent-%COMP%]{color:#000624;font-family:Roboto;font-size:18px;font-style:normal;font-weight:600;line-height:normal}.text-des[_ngcontent-%COMP%]{color:#00062480;font-family:Roboto;font-size:10.5px;font-style:normal;font-weight:400;line-height:normal;opacity:unset!important}.container[_ngcontent-%COMP%]{padding:0!important}"],data:{animation:[(0,b.MH)()]}})),l})(),pathMatch:"full"}];let ie=(()=>{var o;class l{}return o=l,(0,r.Z)(l,"\u0275fac",function(n){return new(n||o)}),(0,r.Z)(l,"\u0275mod",e.oAB({type:o})),(0,r.Z)(l,"\u0275inj",e.cJS({imports:[u.Bz.forChild(ne),u.Bz]})),l})();var le=s(8387),ae=s(40031);let se=(()=>{var o;class l{}return o=l,(0,r.Z)(l,"\u0275fac",function(n){return new(n||o)}),(0,r.Z)(l,"\u0275mod",e.oAB({type:o})),(0,r.Z)(l,"\u0275inj",e.cJS({imports:[ae.o,le.g,ie]})),l})()}}]);