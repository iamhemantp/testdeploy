"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[19350],{19350:(D,m,r)=>{r.r(m),r.d(m,{UnitsModule:()=>Y});var l=r(81180),b=r(8387),C=r(40031),g=r(12236),f=r(41840),Z=r(47530),M=r(64716),t=r(99468),u=r(44328),h=r(96814),c=r(73552),T=r(94901),U=r(56916),y=r(85219),_=r(51712),A=r(68989),p=r(56223),P=r(45513),x=r(42152),w=r(24142),v=r(3291);const z=["unitCreationModal"];function S(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"localize"),t.qZA()),2&o){const s=t.oxw();t.xp6(1),t.AsE("",t.lcZ(2,2,"Update unit"),": ",null==s.unit?null:s.unit.name,"")}}function O(o,a){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"localize"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Create new unit")))}const N=function(o){return{backdrop:"static",keyboard:o}};let J=(()=>{var o;class a extends f.c{constructor(e,n,i,d){super(e),(0,l.Z)(this,"formBuilder",void 0),(0,l.Z)(this,"unitService",void 0),(0,l.Z)(this,"businessService",void 0),(0,l.Z)(this,"modal",void 0),(0,l.Z)(this,"onModalSave",new t.vpe),(0,l.Z)(this,"unitForm",void 0),(0,l.Z)(this,"unit",void 0),(0,l.Z)(this,"businessId",void 0),(0,l.Z)(this,"saving",!1),(0,l.Z)(this,"isEditMode",!1),(0,l.Z)(this,"submitAttempt",!1),this.formBuilder=n,this.unitService=i,this.businessService=d}ngOnInit(){this.unitForm=this.formBuilder.group({unitName:["",p.kI.required]}),this.businessService.getCurrentBusinessId().subscribe(e=>{this.businessId=e})}saveUnit(){if(this.submitAttempt=!0,this.unitForm.valid)if(this.saving=!0,this.isEditMode){const e=new u.nIb;e.id=this.unit.id,e.name=this.unitForm.controls.unitName.value,this.unitService.updateOrganizationUnit(e).subscribe(n=>{this.saving=!1,this.notify.info(this.l("Updated successfully")),this.onModalSave.emit(),this.closeModal()},n=>{this.saving=!1,this.notify.error(`Error: ${null==n?void 0:n.message}`)})}else{const e=new u.xg9;e.businessId=this.businessId,e.name=this.unitForm.controls.unitName.value,this.unitService.createOrganizationUnit(e).subscribe(n=>{this.saving=!1,this.notify.info(this.l("SavedSuccessfully")),this.onModalSave.emit(),this.closeModal()},n=>{this.saving=!1,this.notify.error(`Error: ${null==n?void 0:n.message}`)})}}showModal(e){e?(this.isEditMode=!0,this.unit=e,this.unitForm.patchValue({unitName:null==e?void 0:e.name})):(this.isEditMode=!1,this.unitForm.patchValue({unitName:""})),this.modal.show()}onFocus(){document.getElementById("unitDisplayName").focus()}closeModal(){this.modal.hide()}}return o=a,(0,l.Z)(a,"\u0275fac",function(e){return new(e||o)(t.Y36(t.zs3),t.Y36(p.qu),t.Y36(u.eOu),t.Y36(u.fGn))}),(0,l.Z)(a,"\u0275cmp",t.Xpm({type:o,selectors:[["app-unit-creation-modal"]],viewQuery:function(e,n){if(1&e&&t.Gf(z,7),2&e){let i;t.iGM(i=t.CRH())&&(n.modal=i.first)}},outputs:{onModalSave:"onModalSave"},features:[t.qOj],decls:25,vars:20,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","unitCreationModal","aria-hidden","true",1,"modal","fade","create-or-edit-user-modal",3,"config","onShown"],["unitCreationModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[3,"formGroup"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"mb-5"],["for","name",1,"form-label"],["formControlName","unitName","type","text","name","name","id","unitDisplayName",1,"form-control"],[3,"formCtrl"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"disabled","buttonBusy","busyText","click"],[1,"fa","fa-save"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0,1),t.NdJ("onShown",function(){return n.onFocus()}),t.TgZ(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",5)(6,"h4",6),t.YNc(7,S,3,4,"span",7),t.YNc(8,O,3,3,"span",7),t.qZA(),t.TgZ(9,"button",8),t.NdJ("click",function(){return n.closeModal()}),t.qZA()(),t.TgZ(10,"div",9)(11,"div",10)(12,"label",11),t._uU(13),t.ALo(14,"localize"),t.qZA(),t._UZ(15,"input",12)(16,"validation-messages",13),t.qZA()(),t.TgZ(17,"div",14)(18,"button",15),t.NdJ("click",function(){return n.closeModal()}),t._uU(19),t.ALo(20,"localize"),t.qZA(),t.TgZ(21,"button",16),t.NdJ("click",function(){return n.saveUnit()}),t._UZ(22,"i",17),t.TgZ(23,"span"),t._uU(24),t.qZA()()()()()()()),2&e&&(t.Q6J("config",t.VKq(18,N,!n.saving)),t.xp6(4),t.Q6J("formGroup",n.unitForm),t.xp6(3),t.Q6J("ngIf",null==n.unit?null:n.unit.id),t.xp6(1),t.Q6J("ngIf",!(null!=n.unit&&n.unit.id)),t.xp6(1),t.Q6J("disabled",n.saving),t.uIk("aria-label",n.l("Close")),t.xp6(4),t.hij("",t.lcZ(14,14,"Name")," *"),t.xp6(3),t.Q6J("formCtrl",n.unitForm.controls.unitName),t.xp6(2),t.Q6J("disabled",n.saving),t.xp6(1),t.hij(" ",t.lcZ(20,16,"Cancel")," "),t.xp6(2),t.Q6J("disabled",!n.unitForm.valid)("buttonBusy",n.saving)("busyText",n.l("SavingWithThreeDot")),t.xp6(3),t.Oqu(n.isEditMode?"Update":"Save"))},dependencies:[h.O5,p._Y,p.Fj,p.JJ,p.JL,P.L,x.s,w.Z,p.sg,p.u,v.F]})),a})();const H=["unitCreationModal"],L=["paginator"],F=["dataTable"];function R(o,a){1&o&&(t.TgZ(0,"tr")(1,"th",22),t._uU(2),t.ALo(3,"localize"),t.qZA(),t.TgZ(4,"th",23),t._uU(5),t.ALo(6,"localize"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"Actions")," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"Name")," "))}function I(o,a){if(1&o){const s=t.EpF();t.TgZ(0,"ul",30)(1,"li",31)(2,"a",32),t.NdJ("click",function(){t.CHM(s);const n=t.oxw().$implicit;t.oxw();const i=t.MAs(26);return t.KtG(i.showModal(n))}),t._uU(3),t.ALo(4,"localize"),t.qZA()(),t.TgZ(5,"li",31)(6,"a",32),t.NdJ("click",function(){t.CHM(s);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.deleteSelectedUnit(n))}),t._uU(7),t.ALo(8,"localize"),t.qZA()()()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,"Edit")," "),t.xp6(4),t.hij(" ",t.lcZ(8,4,"Delete")," "))}function j(o,a){if(1&o&&(t.TgZ(0,"tr")(1,"td",22)(2,"div",24)(3,"button",25),t._UZ(4,"i",26)(5,"span",27),t._uU(6),t.ALo(7,"localize"),t.qZA(),t.YNc(8,I,9,6,"ul",28),t.qZA()(),t.TgZ(9,"td",23)(10,"span",29),t._uU(11),t.ALo(12,"localize"),t.qZA(),t._uU(13),t.qZA()()),2&o){const s=a.$implicit;t.xp6(6),t.hij(" ",t.lcZ(7,3,"Actions")," "),t.xp6(5),t.Oqu(t.lcZ(12,5,"Name")),t.xp6(2),t.hij(" ",s.name," ")}}function Q(o,a){1&o&&(t.TgZ(0,"div",33),t._uU(1),t.ALo(2,"localize"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NoData")," "))}const B=function(){return{"min-width":"50rem"}},E=[{path:"",component:(()=>{var o;class a extends f.c{constructor(e,n){super(e),(0,l.Z)(this,"unitService",void 0),(0,l.Z)(this,"unitCreationModal",void 0),(0,l.Z)(this,"paginator",void 0),(0,l.Z)(this,"dataTable",void 0),this.unitService=n}ngOnInit(){}ngAfterViewInit(){this.primengTableHelper.adjustScroll(this.dataTable)}getUnits(e){var n;if(this.primengTableHelper.shouldResetPaging(e)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0))return;this.primengTableHelper.showLoadingIndicator();const i={currentPage:(null==e?void 0:e.page)+1||1,itemsPerPage:(null===(n=this.paginator)||void 0===n?void 0:n.rows)||10};this.unitService.getUnitAll(i.currentPage,i.itemsPerPage).pipe((0,M.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(d=>{this.primengTableHelper.totalRecordsCount=d.totalCount,this.primengTableHelper.records=d.items,this.primengTableHelper.hideLoadingIndicator()},d=>{this.primengTableHelper.hideLoadingIndicator()})}createUnit(){this.unitCreationModal.showModal()}deleteSelectedUnit(e){this.message.confirm(`Are you sure you want to delete ${null==e?void 0:e.name}`,"",n=>{n&&this.unitService.deleteUnit(e.id).subscribe(i=>{this.notify.success(this.l("SuccessfullyDeleted")),this.paginator.changePage(this.paginator.getPage())},i=>{this.notify.error(`Error: ${i.message}`)})})}}return o=a,(0,l.Z)(a,"\u0275fac",function(e){return new(e||o)(t.Y36(t.zs3),t.Y36(u.eOu))}),(0,l.Z)(a,"\u0275cmp",t.Xpm({type:o,selectors:[["app-units"]],viewQuery:function(e,n){if(1&e&&(t.Gf(H,7),t.Gf(L,7),t.Gf(F,7)),2&e){let i;t.iGM(i=t.CRH())&&(n.unitCreationModal=i.first),t.iGM(i=t.CRH())&&(n.paginator=i.first),t.iGM(i=t.CRH())&&(n.dataTable=i.first)}},features:[t.qOj],decls:27,vars:27,consts:[[1,"unit-container","container"],[1,"c-route-page-container"],[1,"p-28"],[3,"title"],["role","actions"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus","btn-md-icon"],[1,"d-none","d-md-inline-block"],[1,"card","card-custom","gutter-b"],[1,"card-body"],[1,"row","align-items-center"],[1,"primeng-datatable-container",3,"busyIf"],["sortMode","multiple","ScrollWidth","100%","scrollDirection","horizontal",3,"value","rows","paginator","lazy","scrollable","tableStyle","resizableColumns","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[3,"onModalSave"],["unitCreationModal",""],[2,"min-width","130px"],[2,"min-width","150px"],["dropdown","","placement","bottom left","container","body",1,"btn-group"],["id","dropdownButton","type","button","dropdownToggle","","aria-controls","dropdownMenu",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog"],[1,"caret"],["id","dropdownMenu","class","dropdown-menu","role","menu","aria-labelledby","dropdownButton",4,"dropdownMenu"],[1,"p-column-title"],["id","dropdownMenu","role","menu","aria-labelledby","dropdownButton",1,"dropdown-menu"],["role","menuitem"],["href","javascript:;",1,"dropdown-item",3,"click"],[1,"primeng-no-data"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"sub-header",3),t.ALo(4,"localize"),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return n.createUnit()}),t._UZ(7,"i",6),t.TgZ(8,"span",7),t._uU(9),t.ALo(10,"localize"),t.qZA()()()()()(),t.TgZ(11,"div")(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11)(16,"p-table",12,13),t.NdJ("onLazyLoad",function(d){return n.getUnits(d)}),t.YNc(18,R,7,6,"ng-template",14),t.YNc(19,j,14,7,"ng-template",15),t.qZA(),t.YNc(20,Q,3,3,"div",16),t.TgZ(21,"div",17)(22,"p-paginator",18,19),t.NdJ("onPageChange",function(d){return n.getUnits(d)}),t.ALo(24,"localize"),t.qZA()()()()()()()(),t.TgZ(25,"app-unit-creation-modal",20,21),t.NdJ("onModalSave",function(){return n.getUnits()}),t.qZA()),2&e&&(t.Q6J("@routerTransition",void 0),t.xp6(3),t.Q6J("title",t.lcZ(4,19,"Units")),t.xp6(6),t.hij(" ",t.lcZ(10,21,"Add new unit")," "),t.xp6(2),t.Tol(n.containerClass),t.xp6(4),t.Q6J("busyIf",n.primengTableHelper.isLoading),t.xp6(1),t.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),t.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("scrollable",!0)("tableStyle",t.DdM(26,B))("resizableColumns",n.primengTableHelper.resizableColumns),t.xp6(4),t.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount),t.xp6(2),t.Q6J("rows",n.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",n.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",n.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",t.xi3(24,23,"TotalRecordsCount",n.primengTableHelper.totalRecordsCount)))},dependencies:[h.O5,c.Hz,c.Mq,c.TO,T.U,U.iA,y.jx,_.D,A.$,J,v.F],styles:[".toolbar[_ngcontent-%COMP%]{height:55px;display:flex;align-items:center;border-top:1px solid #EFF2F5;background:#ffffff;box-shadow:0 10px 30px #523f690d;left:265px;transition:left .3s ease;padding:0 30px}.unit-container[_ngcontent-%COMP%]{background-color:#f5f8ff}.unit-container[_ngcontent-%COMP%]   .c-route-page-container[_ngcontent-%COMP%]{font-family:Roboto,sans-serif}.unit-container[_ngcontent-%COMP%]   .c-route-page-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:1.14rem}.p-28[_ngcontent-%COMP%]{padding-top:28px;padding-bottom:28px}.search[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:50%;padding-bottom:0!important;margin-bottom:0!important}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex-shrink:0;border-radius:12px;background:var(--Primary-Base-White, #FFF);box-shadow:0 25.787px 53.723px 4.298px #5a52800d}.text-header[_ngcontent-%COMP%]{color:#000624;font-family:Roboto;font-size:18px;font-style:normal;font-weight:600;line-height:normal}.text-des[_ngcontent-%COMP%]{color:#00062480;font-family:Roboto;font-size:10.5px;font-style:normal;font-weight:400;line-height:normal;opacity:unset!important}.container[_ngcontent-%COMP%]{padding:0!important}"],data:{animation:[(0,Z.MH)()]}})),a})(),pathMatch:"full"}];let G=(()=>{var o;class a{}return o=a,(0,l.Z)(a,"\u0275fac",function(e){return new(e||o)}),(0,l.Z)(a,"\u0275mod",t.oAB({type:o})),(0,l.Z)(a,"\u0275inj",t.cJS({imports:[g.Bz.forChild(E),g.Bz]})),a})(),Y=(()=>{var o;class a{}return o=a,(0,l.Z)(a,"\u0275fac",function(e){return new(e||o)}),(0,l.Z)(a,"\u0275mod",t.oAB({type:o})),(0,l.Z)(a,"\u0275inj",t.cJS({imports:[C.o,b.g,G]})),a})()}}]);