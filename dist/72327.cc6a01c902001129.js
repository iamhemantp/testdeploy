"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[72327],{96655:(R,E,o)=>{o.d(E,{S:()=>U});var s=o(81180),M=o(41840),t=o(99468),e=o(44328),D=o(58399),Z=o(96814),A=o(24142),b=o(3291);const P=["entityChangeDetailModal"];function L(u,T){if(1&u){const _=t.EpF();t.TgZ(0,"div",9)(1,"h4",10)(2,"span"),t._uU(3),t.ALo(4,"localize"),t.ALo(5,"localize"),t.qZA(),t._UZ(6,"br")(7,"small",11),t.qZA(),t.TgZ(8,"button",12),t.NdJ("click",function(){t.CHM(_);const r=t.oxw();return t.KtG(r.close())}),t.qZA()()}if(2&u){const _=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,4,"Detail")," - ",t.lcZ(5,6,_.entityChange.entityTypeFullName),""),t.xp6(4),t.Q6J("innerHTML",_.l("CreatedAtByUser",_.entityChange.changeTime,_.entityChange.userName),t.oJD),t.xp6(1),t.uIk("aria-label",_.l("Close"))}}function O(u,T){if(1&u&&(t.TgZ(0,"div",13)(1,"div",14)(2,"h3",15)(3,"span",16),t._uU(4),t.qZA()()(),t.TgZ(5,"div",17)(6,"div",18)(7,"div",19)(8,"div",20),t._uU(9),t.ALo(10,"localize"),t.qZA(),t.TgZ(11,"div",21),t._uU(12),t.qZA()(),t.TgZ(13,"div",22)(14,"div",20),t._uU(15),t.ALo(16,"localize"),t.qZA(),t.TgZ(17,"div",21),t._uU(18),t.qZA()()()()()),2&u){const _=T.$implicit,i=t.oxw();t.xp6(4),t.Oqu(_.propertyName),t.xp6(5),t.hij(" ",t.lcZ(10,5,"OriginalValue")," "),t.xp6(3),t.hij(" ",i.getPropertyChangeValue(_.originalValue,_.propertyTypeFullName)," "),t.xp6(3),t.Oqu(t.lcZ(16,7,"NewValue")),t.xp6(3),t.hij(" ",i.getPropertyChangeValue(_.newValue,_.propertyTypeFullName)," ")}}const x=function(){return{backdrop:"static"}};let U=(()=>{var u;class T extends M.c{constructor(i,r,v){super(i),(0,s.Z)(this,"_auditLogService",void 0),(0,s.Z)(this,"_dateTimeService",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"active",!1),(0,s.Z)(this,"entityPropertyChanges",void 0),(0,s.Z)(this,"entityChange",void 0),this._auditLogService=r,this._dateTimeService=v}getPropertyChangeValue(i,r){return i&&(i=i.replace(/^['"]+/g,"").replace(/['"]+$/g,""),this.isDate(i,r)?this._dateTimeService.formatDate(this._dateTimeService.fromISODateString(i),"yyyy-LL-dd HH:mm:ss"):"null"===i?"":i)}isDate(i,r){return r.includes("DateTime")&&!isNaN(Date.parse(i).valueOf())}show(i){const r=this;r.active=!0,r.entityChange=i,this._auditLogService.getEntityPropertyChanges(i.id).subscribe(v=>{r.entityPropertyChanges=v}),r.modal.show()}close(){this.active=!1,this.modal.hide()}}return u=T,(0,s.Z)(T,"\u0275fac",function(i){return new(i||u)(t.Y36(t.zs3),t.Y36(e.xWy),t.Y36(D.C))}),(0,s.Z)(T,"\u0275cmp",t.Xpm({type:u,selectors:[["entityChangeDetailModal"]],viewQuery:function(i,r){if(1&i&&t.Gf(P,7),2&i){let v;t.iGM(v=t.CRH())&&(r.modal=v.first)}},features:[t.qOj],decls:11,vars:7,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","entityChangeDetailModal","aria-hidden","true",1,"modal","fade",3,"config"],["entityChangeDetailModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["class","modal-header",4,"ngIf"],[1,"modal-body"],["class","card card-custom gutter-b",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],[1,"modal-header"],[1,"modal-title"],[3,"innerHTML"],["type","button",1,"btn-close",3,"click"],[1,"card","card-custom","gutter-b"],[1,"card-header","py-5"],[1,"card-title"],[1,"card-label"],[1,"card-body","py-0"],[1,"row","m-0"],[1,"col","px-8","py-6","me-8"],[1,"fs-sm","text-muted","fw-bold"],[1,"fw-bolder"],[1,"col","px-8","py-6"]],template:function(i,r){1&i&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3),t.YNc(4,L,9,8,"div",4),t.TgZ(5,"div",5),t.YNc(6,O,19,9,"div",6),t.qZA(),t.TgZ(7,"div",7)(8,"button",8),t.NdJ("click",function(){return r.close()}),t._uU(9),t.ALo(10,"localize"),t.qZA()()()()()),2&i&&(t.Q6J("config",t.DdM(6,x)),t.xp6(4),t.Q6J("ngIf",r.entityChange),t.xp6(2),t.Q6J("ngForOf",r.entityPropertyChanges),t.xp6(3),t.hij(" ",t.lcZ(10,4,"Close")," "))},dependencies:[Z.sg,Z.O5,A.Z,b.F],encapsulation:2})),T})()},76388:(R,E,o)=>{o.d(E,{A:()=>f});var s=o(81180),M=o(41840),t=o(64716),e=o(99468),D=o(44328),Z=o(96814),A=o(94901),b=o(56916),P=o(85219),L=o(51712),O=o(24142),x=o(96655),U=o(88922),u=o(3291);const T=["entityChangeDetailModal"],_=["modal"],i=["dataTable"],r=["paginator"];function v(g,C){if(1&g&&(e.TgZ(0,"h4",20),e._uU(1),e.ALo(2,"localize"),e.ALo(3,"localize"),e.qZA()),2&g){const y=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,"ChangeLogs")+":"+e.lcZ(3,3,y.options.entityTypeFullName)+"("+y.options.entityTypeDescription+")"," ")}}function n(g,C){1&g&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"localize"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"localize"),e.qZA()()),2&g&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"Select")," "),e.xp6(3),e.hij(" ",e.lcZ(6,6,"Action")," "),e.xp6(3),e.hij(" ",e.lcZ(9,8,"UserName")," "),e.xp6(3),e.hij(" ",e.lcZ(12,10,"Time")," "))}function a(g,C){if(1&g){const y=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"button",22),e.NdJ("click",function(){const m=e.CHM(y).$implicit,I=e.oxw();return e.KtG(I.showEntityChangeDetails(m))}),e.ALo(3,"localize"),e._UZ(4,"i",23),e.qZA()(),e.TgZ(5,"td")(6,"span",24),e._uU(7),e.ALo(8,"localize"),e.qZA(),e._uU(9),e.qZA(),e.TgZ(10,"td")(11,"span",24),e._uU(12),e.ALo(13,"localize"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"td")(16,"span",24),e._uU(17),e.ALo(18,"localize"),e.qZA(),e._uU(19),e.ALo(20,"luxonFormat"),e.qZA()()}if(2&g){const y=C.$implicit,d=e.oxw();e.xp6(2),e.s9C("title",e.lcZ(3,8,"Select")),e.xp6(2),e.uIk("aria-label",d.l("Select")),e.xp6(3),e.Oqu(e.lcZ(8,10,"Action")),e.xp6(2),e.hij(" ",y.changeTypeName," "),e.xp6(3),e.Oqu(e.lcZ(13,12,"UserName")),e.xp6(2),e.hij(" ",y.userName," "),e.xp6(3),e.Oqu(e.lcZ(18,14,"Time")),e.xp6(2),e.hij(" ",e.xi3(20,16,y.changeTime,"F")," ")}}function c(g,C){1&g&&(e.TgZ(0,"div",25),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&g&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const h=function(){return{backdrop:"static"}},p=function(){return{"min-width":"25rem"}};let f=(()=>{var g;class C extends M.c{constructor(d,l){super(d),(0,s.Z)(this,"_auditLogService",void 0),(0,s.Z)(this,"entityChangeDetailModal",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"dataTable",void 0),(0,s.Z)(this,"paginator",void 0),(0,s.Z)(this,"options",void 0),(0,s.Z)(this,"isShown",!1),(0,s.Z)(this,"isInitialized",!1),(0,s.Z)(this,"filterText",""),(0,s.Z)(this,"tenantId",void 0),(0,s.Z)(this,"entityHistoryEnabled",void 0),this._auditLogService=l}show(d){this.options=d,this.modal.show()}refreshTable(){this.paginator.changePage(this.paginator.getPage())}close(){this.modal.hide()}shown(){this.isShown=!0,this.getRecordsIfNeeds(null)}getRecordsIfNeeds(d){this.isShown&&(this.getRecords(d),this.isInitialized=!0)}getRecords(d){this.primengTableHelper.showLoadingIndicator(),this._auditLogService.getEntityTypeChanges(this.options.entityTypeFullName,this.options.entityId,this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,d),this.primengTableHelper.getSkipCount(this.paginator,d)).pipe((0,t.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(l=>{this.primengTableHelper.totalRecordsCount=l.totalCount,this.primengTableHelper.records=l.items,this.primengTableHelper.hideLoadingIndicator()})}showEntityChangeDetails(d){this.entityChangeDetailModal.show(d)}}return g=C,(0,s.Z)(C,"\u0275fac",function(d){return new(d||g)(e.Y36(e.zs3),e.Y36(D.xWy))}),(0,s.Z)(C,"\u0275cmp",e.Xpm({type:g,selectors:[["entityTypeHistoryModal"]],viewQuery:function(d,l){if(1&d&&(e.Gf(T,7),e.Gf(_,7),e.Gf(i,7),e.Gf(r,7)),2&d){let m;e.iGM(m=e.CRH())&&(l.entityChangeDetailModal=m.first),e.iGM(m=e.CRH())&&(l.modal=m.first),e.iGM(m=e.CRH())&&(l.dataTable=m.first),e.iGM(m=e.CRH())&&(l.paginator=m.first)}},features:[e.qOj],decls:24,vars:23,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","modal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["modal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"primeng-datatable-container",3,"busyIf"],[3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],["entityChangeDetailModal",""],[1,"modal-title"],[2,"width","15%"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm",3,"title","click"],[1,"la","la-chevron-circle-right"],[1,"p-column-title"],[1,"primeng-no-data"]],template:function(d,l){1&d&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return l.shown()}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,v,4,5,"h4",5),e.TgZ(6,"button",6),e.NdJ("click",function(){return l.close()}),e.qZA()(),e.TgZ(7,"div",7)(8,"div",8)(9,"p-table",9,10),e.NdJ("onLazyLoad",function(I){return l.getRecordsIfNeeds(I)}),e.YNc(11,n,13,12,"ng-template",11),e.YNc(12,a,21,19,"ng-template",12),e.qZA(),e.YNc(13,c,3,3,"div",13),e.TgZ(14,"div",14)(15,"p-paginator",15,16),e.NdJ("onPageChange",function(I){return l.getRecordsIfNeeds(I)}),e.ALo(17,"localize"),e.qZA()()()(),e.TgZ(18,"div",17)(19,"button",18),e.NdJ("click",function(){return l.close()}),e._uU(20),e.ALo(21,"localize"),e.qZA()()()()(),e._UZ(22,"entityChangeDetailModal",null,19)),2&d&&(e.Q6J("config",e.DdM(21,h)),e.xp6(5),e.Q6J("ngIf",l.options),e.xp6(1),e.uIk("aria-label",l.l("Close")),e.xp6(2),e.Q6J("busyIf",l.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",l.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",l.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(22,p)),e.xp6(4),e.Q6J("ngIf",0==l.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",l.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",l.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",l.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(17,16,"TotalRecordsCount",l.primengTableHelper.totalRecordsCount)),e.xp6(5),e.hij(" ",e.lcZ(21,19,"Close")," "))},dependencies:[Z.O5,A.U,b.iA,P.jx,L.D,O.Z,x.S,U.n,u.F],encapsulation:2})),C})()},43136:(R,E,o)=>{o.d(E,{Z:()=>v});var s=o(94138),M=o(45920);var D=o(14818);const P=function b(n,a){return a.length<2?n:(0,D.Z)(n,function Z(n,a,c){var h=-1,p=n.length;a<0&&(a=-a>p?0:p+a),(c=c>p?p:c)<0&&(c+=p),p=a>c?0:c-a>>>0,a>>>=0;for(var f=Array(p);++h<p;)f[h]=n[h+a];return f}(a,0,-1))};var L=o(77801);const x=function O(n,a){return a=(0,M.Z)(a,n),null==(n=P(n,a))||delete n[(0,L.Z)(function t(n){var a=null==n?0:n.length;return a?n[a-1]:void 0}(a))]};var U=o(19229),T=Array.prototype.splice;const v=function r(n,a){var c=[];if(!n||!n.length)return c;var h=-1,p=[],f=n.length;for(a=(0,s.Z)(a,3);++h<f;){var g=n[h];a(g,h,n)&&(c.push(g),p.push(h))}return function _(n,a){for(var c=n?a.length:0,h=c-1;c--;){var p=a[c];if(c==h||p!==f){var f=p;(0,U.Z)(p)?T.call(n,p,1):x(n,p)}}}(n,p),c}}}]);