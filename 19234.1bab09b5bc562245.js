"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[19234],{19234:(I,h,r)=>{r.r(h),r.d(h,{StripePurchaseModule:()=>C});var e=r(81180),m=r(40031),v=r(91860),u=r(12236),y=r(41840),P=r(49291),S=r(47530),p=r(44328),d=r(15047),i=r(99468);const Z=[{path:"",component:(()=>{var n;class t extends y.c{constructor(s,c,a,l){super(s),(0,e.Z)(this,"_activatedRoute",void 0),(0,e.Z)(this,"_stripePaymentAppService",void 0),(0,e.Z)(this,"_paymentAppService",void 0),(0,e.Z)(this,"editionPaymentType",void 0),(0,e.Z)(this,"amount",0),(0,e.Z)(this,"description",""),(0,e.Z)(this,"subscriptionPayment",void 0),(0,e.Z)(this,"stripeIsLoading",!0),(0,e.Z)(this,"subscriptionPaymentGateway",p.UWJ),(0,e.Z)(this,"subscriptionStartType",p.gPM),(0,e.Z)(this,"paymentId",void 0),(0,e.Z)(this,"successCallbackUrl",void 0),(0,e.Z)(this,"errorCallbackUrl",void 0),this._activatedRoute=c,this._stripePaymentAppService=a,this._paymentAppService=l}ngOnInit(){this.spinnerService.show(),this.setTenantIdCookieIfNeeded(),this.stripeIsLoading=!0,this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,(new P.$).load("https://js.stripe.com/v3").then(()=>{this._stripePaymentAppService.getConfiguration().subscribe(s=>{this._stripePaymentAppService.createPaymentSession(new p.ieL({paymentId:this.paymentId,successUrl:d.g.appBaseUrl+"/account/stripe-payment-result",cancelUrl:d.g.appBaseUrl+"/account/stripe-cancel-payment"})).subscribe(c=>{this._paymentAppService.getPayment(this.paymentId).subscribe(a=>{this.amount=a.amount,this.description=a.description,this.successCallbackUrl=a.successUrl,this.errorCallbackUrl=a.errorUrl,window.Stripe(s.publishableKey).redirectToCheckout({sessionId:c}),this.stripeIsLoading=!1},a=>{this.spinnerService.hide()})},c=>{this.spinnerService.hide()})},s=>{this.spinnerService.hide()})}).catch(s=>{this.spinnerService.hide()})}setTenantIdCookieIfNeeded(){if(!this._activatedRoute.snapshot.queryParams.tenantId)return;let s=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(s)}}return n=t,(0,e.Z)(t,"\u0275fac",function(s){return new(s||n)(i.Y36(i.zs3),i.Y36(u.gz),i.Y36(p.YgH),i.Y36(p.KC))}),(0,e.Z)(t,"\u0275cmp",i.Xpm({type:n,selectors:[["stripe-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[i.qOj],decls:1,vars:1,consts:[[1,"login-form"]],template:function(s,c){1&s&&i._UZ(0,"div",0),2&s&&i.Q6J("@routerTransition",void 0)},encapsulation:2,data:{animation:[(0,S.RP)()]}})),t})(),pathMatch:"full"}];let f=(()=>{var n;class t{}return n=t,(0,e.Z)(t,"\u0275fac",function(s){return new(s||n)}),(0,e.Z)(t,"\u0275mod",i.oAB({type:n})),(0,e.Z)(t,"\u0275inj",i.cJS({imports:[u.Bz.forChild(Z),u.Bz]})),t})(),C=(()=>{var n;class t{}return n=t,(0,e.Z)(t,"\u0275fac",function(s){return new(s||n)}),(0,e.Z)(t,"\u0275mod",i.oAB({type:n})),(0,e.Z)(t,"\u0275inj",i.cJS({imports:[m.o,v.y,f]})),t})()}}]);